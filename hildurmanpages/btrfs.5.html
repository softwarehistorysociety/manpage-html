<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Thu Sep  8 02:33:10 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>BTRFS-MAN5</title>

</head>
<body>

<h1 align="center">BTRFS-MAN5</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#MOUNT OPTIONS">MOUNT OPTIONS</a><br>
<a href="#FILESYSTEM FEATURES">FILESYSTEM FEATURES</a><br>
<a href="#CHECKSUM ALGORITHMS">CHECKSUM ALGORITHMS</a><br>
<a href="#FILESYSTEM LIMITS">FILESYSTEM LIMITS</a><br>
<a href="#BOOTLOADER SUPPORT">BOOTLOADER SUPPORT</a><br>
<a href="#FILE ATTRIBUTES">FILE ATTRIBUTES</a><br>
<a href="#CONTROL DEVICE">CONTROL DEVICE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">btrfs-man5 -
topics about the BTRFS filesystem (mount options, supported
file attributes and other)</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This document
describes topics related to BTRFS that are not specific to
the tools. Currently covers:</p>

<p style="margin-left:17%; margin-top: 1em">1. mount
options</p>

<p style="margin-left:17%; margin-top: 1em">2. filesystem
features</p>

<p style="margin-left:17%; margin-top: 1em">3. checksum
algorithms</p>

<p style="margin-left:17%; margin-top: 1em">4. filesystem
limits</p>

<p style="margin-left:17%; margin-top: 1em">5. bootloader
support</p>

<p style="margin-left:17%; margin-top: 1em">6. file
attributes</p>

<p style="margin-left:17%; margin-top: 1em">7. control
device</p>

<h2>MOUNT OPTIONS
<a name="MOUNT OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This section
describes mount options specific to BTRFS. For the generic
mount options please refer to <b>mount</b>(8) manpage. The
options are sorted alphabetically (discarding the <i>no</i>
prefix).</p>


<p style="margin-left:17%; margin-top: 1em"><b><big>Note</big></b>
<br>
most mount options apply to the whole filesystem and only
options in the first mounted subvolume will take effect.
This is due to lack of implementation and may change in the
future. This means that (for example) you can&rsquo;t set
per-subvolume <i>nodatacow</i>, <i>nodatasum</i>, or
<i>compress</i> using mount options. This should eventually
be fixed, but it has proved to be difficult to implement
correctly within the Linux VFS framework.</p>


<p style="margin-left:11%; margin-top: 1em"><b><big>acl</big></b><big>,
<b>noacl</b></big></p>

<p style="margin-left:17%; margin-top: 1em"><big>(default:
on)</big></p>


<p style="margin-left:17%; margin-top: 1em"><big>Enable/disable
support for Posix Access Control Lists (ACLs). See the
<b>acl</b>(5) manual page for more information about
ACLs.</big></p>

<p style="margin-left:17%; margin-top: 1em"><big>The
support for ACL is build-time configurable
(BTRFS_FS_POSIX_ACL) and mount fails if <i>acl</i> is
requested but the feature is not compiled in.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>autodefrag</b>,
<b>noautodefrag</b></big></p>

<p style="margin-left:17%; margin-top: 1em"><big>(since:
3.0, default: off)</big></p>

<p style="margin-left:17%; margin-top: 1em"><big>Enable
automatic file defragmentation. When enabled, small random
writes into files (in a range of tens of kilobytes,
currently it&rsquo;s 64K) are detected and queued up for the
defragmentation process. Not well suited for large database
workloads.</big></p>

<p style="margin-left:17%; margin-top: 1em"><big>The read
latency may increase due to reading the adjacent blocks that
make up the range for defragmentation, successive write will
merge the blocks in the new location.</big></p>


<p style="margin-left:23%; margin-top: 1em"><big><b><big>Warning</big></b>
<br>
Defragmenting with Linux kernel versions &lt; 3.9 or &ge;
3.14-rc2 as well as with Linux stable kernel versions &ge;
3.10.31, &ge; 3.12.12 or &ge; 3.13.4 will break up the
reflinks of COW data (for example files copied with <b>cp
--reflink</b>, snapshots or de-duplicated data). This may
cause considerable increase of space usage depending on the
broken up reflinks.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b><big>barrier</big></b><big>,
<b>nobarrier</b></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>(default:
on)</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>Ensure
that all IO write operations make it through the device
cache and are stored permanently when the filesystem is at
its consistency checkpoint. This typically means that a
flush command is sent to the device that will synchronize
all pending data and ordinary metadata blocks, then writes
the superblock and issues another flush.</big></big></p>

<p style="margin-left:17%; margin-top: 1em"><big><big>The
write flushes incur a slight hit and also prevent the IO
block scheduler to reorder requests in a more effective way.
Disabling barriers gets rid of that penalty but will most
certainly lead to a corrupted filesystem in case of a crash
or power loss. The ordinary metadata blocks could be yet
unwritten at the time the new superblock is stored
permanently, expecting that the block pointers to metadata
were stored permanently before.</big></big></p>

<p style="margin-left:17%; margin-top: 1em"><big><big>On a
device with a volatile battery-backed write-back cache, the
<i>nobarrier</i> option will not lead to filesystem
corruption as the pending blocks are supposed to make it to
the permanent storage.</big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><b>check_int</b>,
<b>check_int_data</b>,
<b>check_int_print_mask=</b><i>value</i></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>(since:
3.0, default: off)</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>These
debugging options control the behavior of the integrity
checking module (the BTRFS_FS_CHECK_INTEGRITY config option
required). The main goal is to verify that all blocks from a
given transaction period are properly
linked.</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><i>check_int</i>
enables the integrity checker module, which examines all
block write requests to ensure on-disk consistency, at a
large memory and CPU cost.</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><i>check_int_data</i>
includes extent data in the integrity checks, and implies
the <i>check_int</i> option.</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><i>check_int_print_mask</i>
takes a bitmask of BTRFSIC_PRINT_MASK_* values as defined in
<i>fs/btrfs/check-integrity.c</i>, to control the integrity
checker module behavior.</big></big></p>

<p style="margin-left:17%; margin-top: 1em"><big><big>See
comments at the top of <i>fs/btrfs/check-integrity.c</i> for
more information.</big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><b>clear_cache</b></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>Force
clearing and rebuilding of the disk space cache if something
has gone wrong. See also:
<i>space_cache</i>.</big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><b>commit=</b><i>seconds</i></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>(since:
3.12, default: 30)</big></big></p>

<p style="margin-left:17%; margin-top: 1em"><big><big>Set
the interval of periodic transaction commit when data are
synchronized to permanent storage. Higher interval values
lead to larger amount of unwritten data, which has obvious
consequences when the system crashes. The upper bound is not
forced, but a warning is printed if it&rsquo;s more than 300
seconds (5 minutes). Use with care.</big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><b>compress</b>,
<b>compress=</b><i>type[:level]</i>, <b>compress-force</b>,
<b>compress-force=</b><i>type[:level]</i></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>(default:
off, level support since: 5.1)</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>Control
BTRFS file data compression. Type may be specified as
<i>zlib</i>, <i>lzo</i>, <i>zstd</i> or <i>no</i> (for no
compression, used for remounting). If no type is specified,
<i>zlib</i> is used. If <i>compress-force</i> is specified,
then compression will always be attempted, but the data may
end up uncompressed if the compression would make them
larger.</big></big></p>

<p style="margin-left:17%; margin-top: 1em"><big><big>Both
<i>zlib</i> and <i>zstd</i> (since version 5.1) expose the
compression level as a tunable knob with higher levels
trading speed and memory (<i>zstd</i>) for higher
compression ratios. This can be set by appending a colon and
the desired level. Zlib accepts the range [1, 9] and zstd
accepts [1, 15]. If no level is set, both currently use a
default level of 3. The value 0 is an alias for the defaul
level.</big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big>Otherwise
some simple heuristics are applied to detect an
incompressible file. If the first blocks written to a file
are not compressible, the whole file is permanently marked
to skip compression. As this is too simple, the
<i>compress-force</i> is a workaround that will compress
most of the files at the cost of some wasted CPU cycles on
failed attempts. Since kernel 4.15, a set of heuristic
algorithms have been improved by using frequency sampling,
repeated pattern detection and Shannon entropy calculation
to avoid that.</big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><b><big>Note</big></b>
<br>
If compression is enabled, <i>nodatacow</i> and
<i>nodatasum</i> are disabled.</big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><b><big>datacow</big></b><big>,
<b>nodatacow</b></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big>(default:
on)</big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big>Enable
data copy-on-write for newly created files. <i>Nodatacow</i>
implies <i>nodatasum</i>, and disables <i>compression</i>.
All files created under <i>nodatacow</i> are also set the
NOCOW file attribute (see
<b>chattr</b>(1)).</big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><b><big>Note</big></b>
<br>
If <i>nodatacow</i> or <i>nodatasum</i> are enabled,
compression is disabled.</big></big></big></p>

<p style="margin-left:17%;"><big><big><big>Updates in-place
improve performance for workloads that do frequent
overwrites, at the cost of potential partial writes, in case
the write is interrupted (system crash, device
failure).</big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><b><big>datasum</big></b><big>,
<b>nodatasum</b></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big>(default:
on)</big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big>Enable
data checksumming for newly created files. <i>Datasum</i>
implies <i>datacow</i>, ie. the normal mode of operation.
All files created under <i>nodatasum</i> inherit the
&quot;no checksums&quot; property, however there&rsquo;s no
corresponding file attribute (see
<b>chattr</b>(1)).</big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><b><big>Note</big></b>
<br>
If <i>nodatacow</i> or <i>nodatasum</i> are enabled,
compression is disabled.</big></big></big></big></p>

<p style="margin-left:17%;"><big><big><big><big>There is a
slight performance gain when checksums are turned off, the
corresponding metadata blocks holding the checksums do not
need to updated. The cost of checksumming of the blocks in
memory is much lower than the IO, modern CPUs feature
hardware support of the checksumming
algorithm.</big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><b><big>degraded</big></b></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big>(default:
off)</big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big>Allow
mounts with less devices than the RAID profile constraints
require. A read-write mount (or remount) may fail when there
are too many devices missing, for example if a stripe member
is completely missing from
RAID0.</big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big>Since
4.14, the constraint checks have been improved and are
verified on the chunk level, not an the device level. This
allows degraded mounts of filesystems with mixed RAID
profiles for data and metadata, even if the device number
constraints would not be satisfied for some of the
profiles.</big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big>Example:
metadata &mdash; raid1, data &mdash; single, devices &mdash;
/dev/sda, /dev/sdb</big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big>Suppose
the data are completely stored on <i>sda</i>, then missing
<i>sdb</i> will not prevent the mount, even if 1 missing
device would normally prevent (any) <i>single</i> profile to
mount. In case some of the data chunks are stored on
<i>sdb</i>, then the constraint of single/data is not
satisfied and the filesystem cannot be
mounted.</big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><b>device=</b><i>devicepath</i></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big>Specify
a path to a device that will be scanned for BTRFS filesystem
during mount. This is usually done automatically by a device
manager (like udev) or using the <b>btrfs device scan</b>
command (eg. run from the initial ramdisk). In cases where
this is not possible the <i>device</i> mount option can
help.</big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><b><big>Note</big></b>
<br>
booting eg. a RAID1 system may fail even if all
filesystem&rsquo;s <i>device</i> paths are provided as the
actual device nodes may not be discovered by the system at
that point.</big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><b><big>discard</big></b><big>,
<b>nodiscard</b></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>(default:
off)</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>Enable
discarding of freed file blocks. This is useful for SSD
devices, thinly provisioned LUNs, or virtual machine images;
however, every storage layer must support discard for it to
work. if the backing device does not support asynchronous
queued TRIM, then this operation can severely degrade
performance, because a synchronous TRIM operation will be
attempted instead. Queued TRIM requires newer than SATA
revision 3.1 chipsets and
devices.</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>If
it is not necessary to immediately discard freed blocks,
then the <b>fstrim</b> tool can be used to discard all free
blocks in a batch. Scheduling a TRIM during a period of low
system activity will prevent latent interference with the
performance of other operations. Also, a device may ignore
the TRIM command if the range is too small, so running a
batch discard has a greater probability of actually
discarding the
blocks.</big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><b>enospc_debug</b>,
<b>noenospc_debug</b></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>(default:
off)</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>Enable
verbose output for some ENOSPC conditions. It&rsquo;s safe
to use but can be noisy if the system reaches near-full
state.</big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><b>fatal_errors=</b><i>action</i></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>(since:
3.4, default: bug)</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>Action
to take when encountering a fatal
error.</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><b>bug</b></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><i>BUG()</i>
on a fatal error, the system will stay in the crashed state
and may be still partially usable, but reboot is required
for full operation</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><b>panic</b></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><i>panic()</i>
on a fatal error, depending on other system configuration,
this may be followed by a reboot. Please refer to the
documentation of kernel boot parameters, eg. <i>panic</i>,
<i>oops</i> or
<i>crashkernel</i>.</big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><b>flushoncommit</b>,
<b>noflushoncommit</b></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>(default:
off)</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>This
option forces any data dirtied by a write in a prior
transaction to commit as part of the current commit,
effectively a full filesystem
sync.</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>This
makes the committed state a fully consistent view of the
file system from the application&rsquo;s perspective (i.e.
it includes all completed file system operations). This was
previously the behavior only when a snapshot was
created.</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>When
off, the filesystem is consistent but buffered writes may
last more than one transaction
commit.</big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><b>fragment=</b><i>type</i></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>(depends
on compile-time option BTRFS_DEBUG, since: 4.4, default:
off)</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>A
debugging helper to intentionally fragment given <i>type</i>
of block groups. The type can be <i>data</i>,
<i>metadata</i> or <i>all</i>. This mount option should not
be used outside of debugging environments and is not
recognized if the kernel config option <i>BTRFS_DEBUG</i> is
not enabled.</big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><b>inode_cache</b>,
<b>noinode_cache</b></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>(since:
3.0, default: off)</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>Enable
free inode number caching. Not recommended to use unless
files on your filesystem get assigned inode numbers that are
approaching 264. Normally, new files in each subvolume get
assigned incrementally (plus one from the last time) and are
not reused. The mount option turns on caching of the
existing inode numbers and reuse of inode numbers of deleted
files.</big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big>This
option may slow down your system at first run, or after
mounting without the
option.</big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><b><big>Note</big></b>
<br>
Defaults to off due to a potential overflow problem when the
free space checksums don&rsquo;t fit inside a single
page.</big></big></big></big></big></big></p>


<p style="margin-left:17%;"><big><big><big><big><big><big>Don&rsquo;t
use this option unless you really need it. The inode number
limit on 64bit system is 264, which is practically enough
for the whole filesystem lifetime. Due to implementation of
linux VFS layer, the inode numbers on 32bit systems are only
32 bits wide. This lowers the limit significantly and makes
it possible to reach it. In such case, this mount option
will help. Alternatively, files with high inode numbers can
be copied to a new subvolume which will effectively start
the inode numbers from the beginning
again.</big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><b><big>logreplay</big></b><big>,
<b>nologreplay</b></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big>(default:
on, even
read-only)</big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big>Enable/disable
log replay at mount time. See also <i>treelog</i>. Note that
<i>nologreplay</i> is the same as
<i>norecovery</i>.</big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><b><big>Warning</big></b>
<br>
currently, the tree log is replayed even with a read-only
mount! To disable that behaviour, mount also with
<i>nologreplay</i>.</big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><b><big>max_inline=</big></b><big><i>bytes</i></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big>(default:
min(2048, page size)
)</big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big>Specify
the maximum amount of space, that can be inlined in a
metadata B-tree leaf. The value is specified in bytes,
optionally with a K suffix (case insensitive). In practice,
this value is limited by the filesystem block size (named
<i>sectorsize</i> at mkfs time), and memory page size of the
system. In case of sectorsize limit, there&rsquo;s some
space unavailable due to leaf headers. For example, a 4k
sectorsize, maximum size of inline data is about 3900
bytes.</big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big>Inlining
can be completely turned off by specifying 0. This will
increase data block slack if file sizes are much smaller
than block size but will reduce metadata consumption in
return.</big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
the default value has changed to 2048 in kernel
4.6.</big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><b><big>metadata_ratio=</big></b><big><i>value</i></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big>(default:
0, internal
logic)</big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big>Specifies
that 1 metadata chunk should be allocated after every
<i>value</i> data chunks. Default behaviour depends on
internal logic, some percent of unused metadata space is
attempted to be maintained but is not always possible if
there&rsquo;s not enough space left for chunk allocation.
The option could be useful to override the internal logic in
favor of the metadata allocation if the expected workload is
supposed to be metadata intense (snapshots, reflinks,
xattrs, inlined
files).</big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><b>norecovery</b></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big>(since:
4.5, default:
off)</big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big>Do
not attempt any data recovery at mount time. This will
disable <i>logreplay</i> and avoids other write operations.
Note that this option is the same as
<i>nologreplay</i>.</big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
The opposite option <i>recovery</i> used to have different
meaning but was changed for consistency with other
filesystems, where <i>norecovery</i> is used for skipping
log replay. BTRFS does the same and in general will try to
avoid any write
operations.</big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><b><big>rescan_uuid_tree</big></b></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>(since:
3.12, default:
off)</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>Force
check and rebuild procedure of the UUID tree. This should
not normally be
needed.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><b>skip_balance</b></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>(since:
3.3, default:
off)</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>Skip
automatic resume of an interrupted balance operation. The
operation can later be resumed with <b>btrfs balance
resume</b>, or the paused state can be removed with <b>btrfs
balance cancel</b>. The default behaviour is to resume an
interrupted balance immediately after a volume is
mounted.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><b>space_cache</b>,
<b>space_cache=</b><i>version</i>,
<b>nospace_cache</b></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>(<i>nospace_cache</i>
since: 3.2, <i>space_cache=v1</i> and <i>space_cache=v2</i>
since 4.5, default:
<i>space_cache=v1</i>)</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>Options
to control the free space cache. The free space cache
greatly improves performance when reading block group free
space into memory. However, managing the space cache
consumes some resources, including a small amount of disk
space.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>There
are two implementations of the free space cache. The
original one, referred to as <i>v1</i>, is the safe default.
The <i>v1</i> space cache can be disabled at mount time with
<i>nospace_cache</i> without
clearing.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>On
very large filesystems (many terabytes) and certain
workloads, the performance of the <i>v1</i> space cache may
degrade drastically. The <i>v2</i> implementation, which
adds a new B-tree called the free space tree, addresses this
issue. Once enabled, the <i>v2</i> space cache will always
be used and cannot be disabled unless it is cleared. Use
<i>clear_cache,space_cache=v1</i> or
<i>clear_cache,nospace_cache</i> to do so. If <i>v2</i> is
enabled, kernels without <i>v2</i> support will only be able
to mount the filesystem in read-only mode. The
<b>btrfs</b>(8) command currently only has read-only support
for <i>v2</i>. A read-write command may be run on a
<i>v2</i> filesystem by clearing the cache, running the
command, and then remounting with
<i>space_cache=v2</i>.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>If
a version is not explicitly specified, the default
implementation will be chosen, which is
<i>v1</i>.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><b>ssd</b>,
<b>ssd_spread</b>, <b>nossd</b>,
<b>nossd_spread</b></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>(default:
SSD
autodetected)</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>Options
to control SSD allocation schemes. By default, BTRFS will
enable or disable SSD optimizations depending on status of a
device with respect to rotational or non-rotational type.
This is determined by the contents of
<i>/sys/block/DEV/queue/rotational</i>). If it is 0, the
<i>ssd</i> option is turned on. The option <i>nossd</i> will
disable the
autodetection.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big>The
optimizations make use of the absence of the seek penalty
that&rsquo;s inherent for the rotational devices. The blocks
can be typically written faster and are not offloaded to
separate
threads.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
Since 4.14, the block layout optimizations have been
dropped. This used to help with first generations of SSD
devices. Their FTL (flash translation layer) was not
effective and the optimization was supposed to improve the
wear by better aligning blocks. This is no longer true with
modern SSD devices and the optimization had no real benefit.
Furthermore it caused increased fragmentation. The layout
tuning has been kept intact for the option
<i>ssd_spread</i>.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%;"><big><big><big><big><big><big><big><big><big><big>The
<i>ssd_spread</i> mount option attempts to allocate into
bigger and aligned chunks of unused space, and may perform
better on low-end SSDs. <i>ssd_spread</i> implies
<i>ssd</i>, enabling all other SSD heuristics as well. The
option <i>nossd</i> will disable all SSD options while
<i>nossd_spread</i> only disables
<i>ssd_spread</i>.</big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><b><big>subvol=</big></b><big><i>path</i></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big>Mount
subvolume from <i>path</i> rather than the toplevel
subvolume. The <i>path</i> is always treated as relative to
the toplevel subvolume. This mount option overrides the
default subvolume set for the given
filesystem.</big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><b>subvolid=</b><i>subvolid</i></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big>Mount
subvolume specified by a <i>subvolid</i> number rather than
the toplevel subvolume. You can use <b>btrfs subvolume
list</b> of <b>btrfs subvolume show</b> to see subvolume ID
numbers. This mount option overrides the default subvolume
set for the given
filesystem.</big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
if both <i>subvolid</i> and <i>subvol</i> are specified,
they must point at the same subvolume, otherwise the mount
will
fail.</big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><b><big>thread_pool=</big></b><big><i>number</i></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big>(default:
min(NRCPUS + 2, 8)
)</big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big>The
number of worker threads to start. NRCPUS is number of
on-line CPUs detected at the time of mount. Small number
leads to less parallelism in processing data and metadata,
higher numbers could lead to a performance hit due to
increased locking contention, process scheduling, cache-line
bouncing or costly data transfers between local CPU
memories.</big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><b>treelog</b>,
<b>notreelog</b></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big>(default:
on)</big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big>Enable
the tree logging used for <i>fsync</i> and <i>O_SYNC</i>
writes. The tree log stores changes without the need of a
full filesystem sync. The log operations are flushed at sync
and transaction commit. If the system crashes between two
such syncs, the pending tree log operations are replayed
during
mount.</big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><b><big>Warning</big></b>
<br>
currently, the tree log is replayed even with a read-only
mount! To disable that behaviour, also mount with
<i>nologreplay</i>.</big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%;"><big><big><big><big><big><big><big><big><big><big><big><big>The
tree log could contain new files/directories, these would
not exist on a mounted filesystem if the log is not
replayed.</big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><b><big>usebackuproot</big></b><big>,
<b>nousebackuproot</b></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big>(since:
4.6, default:
off)</big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big>Enable
autorecovery attempts if a bad tree root is found at mount
time. Currently this scans a backup list of several previous
tree roots and tries to use the first readable. This can be
used with read-only mounts as
well.</big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
This option has replaced
<i>recovery</i>.</big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><b><big>user_subvol_rm_allowed</big></b></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big>(default:
off)</big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big>Allow
subvolumes to be deleted by their respective owner.
Otherwise, only the root user can do
that.</big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
historically, any user could create a snapshot even if he
was not owner of the source subvolume, the subvolume
deletion has been restricted for that reason. The subvolume
creation has been restricted but this mount option is still
required. This is a usability issue. Since 4.18, the
<b>rmdir</b>(2) syscall can delete an empty subvolume just
like an ordinary directory. Whether this is possible can be
detected at runtime, see <i>rmdir_subvol</i> feature in
<i>FILESYSTEM
FEATURES</i>.</big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b><big>DEPRECATED
MOUNT OPTIONS</big></b> <big><br>
List of mount options that have been removed, kept for
backward
compatibility.</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b>alloc_start=</b><i>bytes</i></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big>(default:
1M, minimum: 1M, deprecated since:
4.13)</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big>Debugging
option to force all block allocations above a certain byte
threshold on each block device. The value is specified in
bytes, optionally with a K, M, or G suffix (case
insensitive).</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b>recovery</b></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big>(since:
3.2, default: off, deprecated since:
4.5)</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b><big>Note</big></b>
<br>
this option has been replaced by <i>usebackuproot</i> and
should not be used but will work on 4.5+
kernels.</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b><big>subvolrootid=</big></b><big><i>objectid</i></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big>(irrelevant
since: 3.2, formally deprecated since:
3.10)</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big>A
workaround option from times (pre 3.2) when it was not
possible to mount a subvolume that did not reside directly
under the toplevel
subvolume.</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b>NOTES
ON GENERIC MOUNT OPTIONS</b> <br>
Some of the general mount options from <b>mount</b>(8) that
affect BTRFS and are worth
mentioning.</big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><b>noatime</b></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big>under
read intensive work-loads, specifying <i>noatime</i>
significantly improves performance because no new access
time information needs to be written. Without this option,
the default is <i>relatime</i>, which only reduces the
number of inode atime updates in comparison to the
traditional <i>strictatime</i>. The worst case for atime
updates under <i>relatime</i> occurs when many files are
read whose atime is older than 24 h and which are freshly
snapshotted. In that case the atime is updated <i>and</i>
COW happens - for each file - in bulk. See also
<b><font color="#0000FF">https://lwn.net/Articles/499293/</font></b>
<font color="#000000">- <i>Atime and btrfs: a bad
combination? (LWN,
2012-05-31)</i>.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">Note
that <i>noatime</i> may break applications that rely on
atime uptimes like the venerable Mutt (unless you use
maildir
mailboxes).</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>FILESYSTEM FEATURES
<a name="FILESYSTEM FEATURES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">The
basic set of filesystem features gets extended over time.
The backward compatibility is maintained and the features
are optional, need to be explicitly asked for so accidental
use will not create
incompatibilities.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">There
are several classes and the respective tools to manage the
features:</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">at
mkfs time
only</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">This
is namely for core structures, like the b-tree nodesize or
checksum algorithm, see <b>mkfs.btrfs</b>(8) for more
details.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">after
mkfs, on an unmounted
filesystem</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">Features
that may optimize internal structures or add new structures
to support new functionality, see <b>btrfstune</b>(8). The
command <b>btrfs inspect-internal dump-super device</b> will
dump a superblock, you can map the value of
<i>incompat_flags</i> to the features listed
below</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">after
mkfs, on a mounted
filesystem</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">The
features of a filesystem (with a given UUID) are listed in
<b>/sys/fs/btrfs/UUID/features/</b>, one file per feature.
The status is stored inside the file. The value <i>1</i> is
for enabled and active, while <i>0</i> means the feature was
enabled at mount time but turned off
afterwards.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">Whether
a particular feature can be turned on a mounted filesystem
can be found in the directory
<b>/sys/fs/btrfs/features/</b>, one file per feature. The
value <i>1</i> means the feature can be
enabled.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">List
of features (see also <b>mkfs.btrfs</b>(8) section
<i>FILESYSTEM
FEATURES</i>):</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>big_metadata</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
3.4)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
filesystem uses <i>nodesize</i> for metadata blocks, this
can be bigger than the page
size</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>compress_lzo</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
2.6.38)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
<i>lzo</i> compression has been used on the filesystem,
either as a mount option or via <b>btrfs filesystem
defrag</b>.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>compress_zstd</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
4.14)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
<i>zstd</i> compression has been used on the filesystem,
either as a mount option or via <b>btrfs filesystem
defrag</b>.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>default_subvol</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
2.6.34)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
default subvolume has been set on the
filesystem</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>extended_iref</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
3.7)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">increased
hardlink limit per file in a directory to 65536, older
kernels supported a varying number of hardlinks depending on
the sum of all file name sizes that can be stored into one
metadata
block</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>metadata_uuid</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
5.0)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
main filesystem UUID is the metadata_uuid, which stores the
new UUID only in the superblock while all metadata blocks
still have the UUID set at mkfs time, see
<b>btrfstune</b>(8) for
more</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>mixed_backref</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
2.6.31)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
last major disk format change, improved backreferences, now
default</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>mixed_groups</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
2.6.37)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">mixed
data and metadata block groups, ie. the data and metadata
are not separated and occupy the same block groups, this
mode is suitable for small volumes as there are no
constraints how the remaining space should be used (compared
to the split mode, where empty metadata space cannot be used
for data and vice
versa)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">on
the other hand, the final layout is quite unpredictable and
possibly highly fragmented, which means worse
performance</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>no_holes</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
3.14)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">improved
representation of file extents where holes are not
explicitly stored as an extent, saves a few percent of
metadata if sparse files are
used</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>raid56</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
3.9)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
filesystem contains or contained a raid56 profile of block
groups</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>rmdir_subvol</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
4.18)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">indicate
that <b>rmdir</b>(2) syscall can delete an empty subvolume
just like an ordinary directory. Note that this feature only
depends on the kernel
version.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>skinny_metadata</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">(since:
3.10)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">reduced-size
metadata for extent references, saves a few percent of
metadata</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>SWAPFILE
SUPPORT</b> <br>
The swapfile is supported since kernel 5.0. Use
<b>swapon</b>(8) to activate the swapfile. There are some
limitations of the implementation in btrfs and linux swap
subystem:</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
filesystem - must be only single
device</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
swapfile - the containing subvolume cannot be
snapshotted</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
swapfile - must be
preallocated</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
swapfile - must be nodatacow (ie. also
nodatasum)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
swapfile - must not be
compressed</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">The
limitations come namely from the COW-based design and
mapping layer of blocks that allows the advanced features
like relocation and multi-device filesystems. However, the
swap subsystem expects simpler mapping and no background
changes of the file blocks once they&rsquo;ve been attached
to
swap.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">With
active swapfiles, the following whole-filesystem operations
will skip swapfile extents or may
fail:</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
balance - block groups with swapfile extents are skipped and
reported, the rest will be processed
normally</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
resize grow -
unaffected</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
resize shrink - works as long as the extents are outside of
the shrunk
range</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
device add - a new device does not interfere with existing
swapfile and this operation will work, though no new
swapfile can be activated
afterwards</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
device delete - if the device has been added as above, it
can be also
deleted</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">&bull;
device replace -
ditto</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">When
there are no active swapfiles and a whole-filesystem
exclusive operation is running (ie. balance, device delete,
shrink), the swapfiles cannot be temporarily activated. The
operation must finish
first.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">#
truncate -s 0 swapfile <br>
# chattr +C swapfile <br>
# fallocate -l 2G swapfile <br>
# chmod 0600 swapfile <br>
# mkswap swapfile <br>
# swapon
swapfile</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>CHECKSUM ALGORITHMS
<a name="CHECKSUM ALGORITHMS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">There
are several checksum algorithms supported. The default and
backward compatible is <i>crc32c</i>. Since kernel 5.5 there
are three more with different characteristics and trade-offs
regarding speed and strength. The following list may help
you to decide which one to
select.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>CRC32C</b>
(32bit
digest)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">default,
best backward compatibility, very fast, modern CPUs have
instruction-level support, not collision-resistant but still
good error detection
capabilities</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>XXHASH</b>
(64bit
digest)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">can
be used as CRC32C successor, very fast, optimized for modern
CPUs utilizing instruction pipelining, good collision
resistance and error
detection</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>SHA256</b>
(256bit
digest)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">a
cryptographic-strength hash, relatively slow but with
possible CPU instruction acceleration or specialized
hardware cards, FIPS certified and in wide
use</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>BLAKE2b</b>
(256bit
digest)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">a
cryptographic-strength hash, relatively fast with possible
CPU acceleration using SIMD extensions, not standardized but
based on BLAKE which was a SHA3 finalist, in wide use, the
algorithm used is BLAKE2b-256 that&rsquo;s optimized for
64bit
platforms</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">The
<i>digest size</i> affects overall size of data block
checksums stored in the filesystem. The metadata blocks have
a fixed area up to 256bits (32 bytes), so there&rsquo;s no
increase. Each data block has a separate checksum stored,
with additional overhead of the b-tree
leaves.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">Approximate
relative performance of the algorithms, measured against
CRC32C using reference software implementations on a 3.5GHz
intel
CPU:</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">[
cols=&quot;^,&gt;,&gt;&quot;,width=&quot;50%&quot;
]</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>FILESYSTEM LIMITS
<a name="FILESYSTEM LIMITS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">maximum
file name
length</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">255</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">maximum
symlink target
length</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">depends
on the <i>nodesize</i> value, for 4k it&rsquo;s 3949 bytes,
for larger nodesize it&rsquo;s 4095 due to the system limit
PATH_MAX</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">The
symlink target may not be a valid path, ie. the path name
components can exceed the limits (NAME_MAX), there&rsquo;s
no content validation at <b>symlink</b>(3)
creation.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">maximum
number of
inodes</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">264
but depends on the available metadata space as the inodes
are created
dynamically</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">inode
numbers</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">minimum
number: 256 (for subvolumes), regular files and directories:
257</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">maximum
file
length</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">inherent
limit of btrfs is 264 (16 EiB) but the linux VFS limit is
263 (8
EiB)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">maximum
number of
subvolumes</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">the
subvolume ids can go up to 264 but the number of actual
subvolumes depends on the available metadata space, the
space consumed by all subvolume metadata includes
bookkeeping of shared extents can be large (MiB,
GiB)</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">maximum
number of hardlinks of a file in a
directory</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">65536
when the <b>extref</b> feature is turned on during mkfs
(default), roughly 100
otherwise</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>BOOTLOADER SUPPORT
<a name="BOOTLOADER SUPPORT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">GRUB2
(</font><b><font color="#0000FF">https://www.gnu.org/software/grub</font></b><font color="#000000">)
has the most advanced support of booting from BTRFS with
respect to
features.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">EXTLINUX
(from the</font>
<b><font color="#0000FF">https://syslinux.org</font></b>
<font color="#000000">project) can boot but does not support
all features. Please check the upstream documentation before
you use
it.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>FILE ATTRIBUTES
<a name="FILE ATTRIBUTES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">The
btrfs filesystem supports setting the following file
attributes using the <b>chattr</b>(1)
utility:</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>a</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><i>append
only</i>, new writes are always written at the end of the
file</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>A</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><i>no
atime
updates</i></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>c</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><i>compress
data</i>, all data written after this attribute is set will
be compressed. Please note that compression is also affected
by the mount options or the parent directory
attributes.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">When
set on a directory, all newly created files will inherit
this
attribute.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b>C</b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><i>no
copy-on-write</i>, file modifications are done
in-place</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000">When
set on a directory, all newly created files will inherit
this
attribute.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:23%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b><big>Note</big></b>
<br>
due to implementation limitations, this flag can be
set/unset only on empty
files.</font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><b><big>d</big></b></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><i>no
dump</i>, makes sense with 3rd party tools like
<b>dump</b>(8), on BTRFS the attribute can be set/unset but
no other special handling is
done</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><b>D</b></big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><i>synchronous
directory updates</i>, for more details search
<b>open</b>(2) for <i>O_SYNC</i> and
<i>O_DSYNC</i></big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><b>i</b></big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><i>immutable</i>,
no file data and metadata changes allowed even to the root
user as long as this attribute is set (obviously the
exception is unsetting the
attribute)</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><b>S</b></big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><i>synchronous
updates</i>, for more details search <b>open</b>(2) for
<i>O_SYNC</i> and
<i>O_DSYNC</i></big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><b>X</b></big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><i>no
compression</i>, permanently turn off compression on the
given file. Any compression mount options will not affect
this
file.</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>When
set on a directory, all newly created files will inherit
this
attribute.</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>No
other attributes are supported. For the complete list please
refer to the <b>chattr</b>(1) manual
page.</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>CONTROL DEVICE
<a name="CONTROL DEVICE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>There&rsquo;s
a character special device <b>/dev/btrfs-control</b> with
major and minor numbers 10 and 234 (the device can be found
under the <i>misc</i>
category).</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>$
ls -l /dev/btrfs-control <br>
crw------- 1 root root 10, 234 Jan 1 12:00
/dev/btrfs-control</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>The
device accepts some ioctl calls that can perform following
actions on the filesystem
module:</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>&bull;
scan devices for btrfs filesystem (ie. to let multi-device
filesystems mount automatically) and register them with the
kernel
module</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>&bull;
similar to scan, but also wait until the device scanning
process is finished for a given
filesystem</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>&bull;
get the supported features (can be also found under
<i>/sys/fs/btrfs/features</i>)</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>The
device is usually created by a system device node manager
(eg. udev), but can be created
manually:</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:17%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>#
mknod --mode=600 c 10 234
/dev/btrfs-control</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>


<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big>The
control device is not strictly required but the device
scanning will not work and a workaround would need to be
used to mount a multi-device filesystem. The mount option
<i>device</i> can trigger the device scanning during
mount.</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><big><font color="#000000"><big><b>acl</b>(5),
<b>btrfs</b>(8), <b>chattr</b>(1), <b>fstrim</b>(8),
<b>ioctl</b>(2), <b>mkfs.btrfs</b>(8), <b>mount</b>(8),
<b>swapon</b>(8)</big></font></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></big></p>
<hr>
</body>
</html>
